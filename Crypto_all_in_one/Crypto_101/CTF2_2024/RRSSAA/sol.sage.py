

# This file was *autogenerated* from the file sol.sage
from sage.all_cmdline import *   # import sage library

_sage_const_8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827 = Integer(8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827); _sage_const_1 = Integer(1); _sage_const_5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355 = Integer(5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355); _sage_const_2 = Integer(2); _sage_const_5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780 = Integer(5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780); _sage_const_3 = Integer(3); _sage_const_5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113 = Integer(5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113); _sage_const_4 = Integer(4); _sage_const_4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209 = Integer(4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209); _sage_const_7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867 = Integer(7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867); _sage_const_6 = Integer(6); _sage_const_5 = Integer(5); _sage_const_0 = Integer(0)
from Crypto.Util.number import *

p = _sage_const_8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827 
v_me_50 = [(_sage_const_1 , _sage_const_5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355 ), (_sage_const_2 , _sage_const_5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780 ), (_sage_const_3 , _sage_const_5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113 ), (_sage_const_4 , _sage_const_4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209 )]
f_flag = _sage_const_7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867 

def h():
    global a, b, x
    x = (a*x + b)
    return x

PR = PolynomialRing(GF(p), names=('a', 'b', 'x',)); (a, b, x,) = PR._first_ngens(3)
h_ = [h() for _ in range(_sage_const_6 )]
eqs =[]
for X, (i, f_i) in zip(range(_sage_const_1 , _sage_const_5 ), v_me_50):
    eqs.append(sum([_ * (i ** __) for (_, __) in (zip(h_, list(range(_sage_const_0 , _sage_const_6 ))))]) - f_i)

I = PR.ideal(eqs)
c = []
for i in I.groebner_basis():
    c.append(i.univariate_polynomial().change_ring(Zmod(p)).roots()[_sage_const_0 ][_sage_const_0 ])

a, b, x = c
def h():
    global a, b, x
    x = (a*x + b)
    return x
PR = PolynomialRing(GF(p), names=('X',)); (X,) = PR._first_ngens(1)
f = h() + h()*X + h()*X**_sage_const_2  + h()*X**_sage_const_3  + h()*X**_sage_const_4  + h()*X**_sage_const_5  - f_flag

print(long_to_bytes(int(f.roots()[_sage_const_0 ][_sage_const_0 ])))

