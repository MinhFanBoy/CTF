
from math import log2
from Crypto.Util.number import bytes_to_long, long_to_bytes, isPrime
import hashlib
import random
import os
import string
from pwn import *
import json
from tqdm import trange
from sympy.ntheory.modular import crt

primes = [134872896248674110356235449403815418010782434477790077399816061391474984100999473800845475384045585995094102614942284052271592474517954812833468137986494001481025490943062104952673148121980420429262226688761069902144587873848357979698702642378176066304113442251131741825755557870772370709891512694005467473501, 25064319902677656764428555188071741933615897550664172064713307313689980137795117418140427231890035405104817707853587229562812427819412545039310902343110388542294213357605043014866659941651454035146668384785564941426787675748971102028766766340661675702491433782745507275263416473001185131552243791242724041903, 24605473579379838356993969272854067820529492918365252467552229544433126236494583681005394437620081311927677059882868008764536243959289577126785086452976305410123733488506711807178639038783651604907202975964980386095156890655125437847248942230634532116569330798571548548903996661561176523968592572393391131763, 19520057380071442903204030665944126078568429211516803302738366080381184039639657677161515025980517664960188044266521404387104282393261802359955112939616270110649110153568975377351995399255480338343061814494123211421298261142082525141501571953333451716559975542203540869097523698684690580382783631560466780573, 130749873798176336909508317106485321264785541150950056611786068651176770734636903476032024993903957404905020347903073749322227656436818533509221439172145086341040084513135977151710777670628947395067080891648806597752982729272914054820883103190097162673242129329749644065760396665671296310940284799814377063861, 58439145178830961203368652885965803469157607058728637441657518876880127757910425099916758899968418225894417930523095738218023181879602284185558864312004042275539211068515068919106326115276206839575663925896734169265679550277496487729116799212220702309767506310817572938235217902939377299057378049517233458937]
lst = [[93181243176473204402916203324529633176040404680247639028566498336301566403233120452066357059231961087643015160550956977493779299129256353723462239195853280495598662385033198180405078180802423499203834812037279019799298584397329735587832986055895150042014663998125941157971277396471963943097892285608293897182, 9503259909454527716143002143846560861851582995378664538480351465276907189431373246856249399787834324950124026771498559444337882608532163296162738697776726371118528228523517796330298846268059207300431636187294985839306791566182570638692550816506656555323284293098570549037483255547313518691624036046146268469, 134872896248674110356235449403815418010782434477790077399816040077735989199576649302431837136236952100795446196932816945958543250942768759323460989680668308627786483969862508426145527677896410729181692586427342061870841022578180083440000031169383533948016126935427807386716879796482591993440777406031416776791, 6575799337625123212728933798782181644228262843434197456667290799342489154887752565632195529136193130348711222835151272853054272722963984585760263036389225], [23770074559761247882778169036774669389222580375468189000659510117563804596313080419048184490575641908863835033868153858383934367413175463105051913170528611903704858163519775591871964080798786113114032526904500251996877691996571770420694732855490050180177500783484978242829440880540156793240312691905901880116, 2136065153464062996200855008552731045499593601884276315407788064901874487196062716587199943254807873534445754304006874331135134321966586454873129284044417537071994749394018774112804751982921535233213661476312745853700758390979570902757872579901927192516543916342439534213657073561457370334592944380037054415, 25064319902677656764428555188071741933615897550664172064713306528171573516604252963363226626218479703300948083304990818220237299018495577044276425647865596390650936238503869550780675317145131611711517253913404837212487928042743653866164471896822954979376652379489575467163457533164564188577649444950455750003, 242351256116424043173573226771601862890217983836869931549919819642559345901989876795043743679321288280504522768801378983426679068626207746396084956435984], [2070772289819444072042439280388188107277543709388686267799464679286249109878027860137043577868678399753455266357329197696089137315625814448722374164018218246196033116290175987724686831711756460762459197381904844125632954166270124105500716630835609791285869352953997327562906007490877880548787414533635446526, 10863376761483240827586104879313743878175772818408096522445703536068356158651732509181005482504236158271352360658701970746790566138197072806339863976204461365253831832047910393342970254018288745938826972336617687703066919221069160780538591416601674092754209914922515552536356959157218000054823573332210695755, 24605473579379838356993969272854067820529492918365252467552229539756229239450475517216018338109976414359277533855114964115811641558301807250069519143431642792773564304875917636399160134611948871888501653383132937292791426258933293505259898013252487236971959663450102918264911751083968784964563420394666634569, 1442934821650039387598690475908174624659077238883087835198993267157082228279740829809774035193117311502623757011824542951178985257299383646696982602500], [17172276453095674413373114506192291639250181687462488915223321316793218809552505315619936583789768087412838469772882580770848046887963837971974324425917257791957727218326467414079527109983627049129103098297259256972439924400685496396661638740712171137069159797568873197838412560436346356267276936633467817808, 17941171220034083138396169179931326107961277134869031429429389312572258407332920048149307936844198943890693025530224845472799181872163345977207577009490321056272519624405335688421264129434541562788277855767085062850896263394536328986522697357515050723944723835097749421015697509695681100550503979200362118482, 19520057380071442903204030665944126078568429211516803302738322778289675450275545734561489177550175219796912848569105482168082334505250915168435786149155932978622101237470610741499309724637243295913478199912067025822736058351138330358344346597211118400980156513348751982297292083698410686474430738548320650246, 13359733115249278562832081504621299997975042685531450908256382390767948165070684832583643771912023932015860277883730751396118162350980114692562701237916929], [58809967559643518379680146686419244876354240327963762298544742884310992251330370277557698381133186483317968308145695670403594238090881647108262656827210612325538287027897461417791489650524365029386760287407180105189404634308517332083768256610273965627469411272492610737251011701400650989672652075325351286583, 1322196869692269267305392390670765504338347742933682976307338998604972322777529760740628804669522049667866253443484771656975063855413742387579545081762638082281372871871168739124285424101163738240844738194319124341665514482965831919167220576524986084666256097460305268111946956372727987542099863993939102970, 130749873798176336909508317106485321264785541150950056611786068643371627254151186489905141017191107552696584036733960587703416655956395763763921665165268992503203622082802448055967110428723340514563265099181868264990216033808888877716331465648463927035540261412906499703093806535265986695405841992193300121352, 2408073841071469294368470653903541498241845452820662415074408564961853018983998686315186715158845946005150295909380693953207416279363694322488640548036], [13802865951539014437592386249773561422184065032551906071738004053377350832136978504384947265330431280338692142477539930128813186740487181631541559478456872420404425326688441271500924514960213800521808404476899524925853902207278987051855242145345083186973581570516604335111848788046895861881698625546537439601, 44583438498392603978149973507705709591668871675842284042243624626167667874790853092894588978303982191241962250076817750443129285853028610146609540518425335105795984759544485954578224864998808107437561571673151777846564741163179412962081572021703000177583487854563052524618620350390367243566913376852501880815, 58439145178830961203368652885965803469157607058728637441657512661929113706876203716750599006988071625731049139708244239188233623508734148051438561549540231639084793187973186828136827853530765852217937562161164330987330605224814981312679038880335460013077479225082405372580001169546765967690515478488737656716, 1917461350697111536345781396395716547307073268503374038929933643200283037254868790074102061698192979718849702050252632043867906604222005912199772279241025]]
nonce = b'z\x13\xfd!\x02\x04\x17\x10\x80qof\xf4\xfd\x9d\x9a5\x8e\xbd\xac\x854\xca\xab\xa8\xa1\xc1\xa4\x7fYe'
g = 2
for p, (y, t, r, c)  in zip(primes, lst):
    c = bytes_to_long(hashlib.sha3_256(long_to_bytes(t ^ y ^ g)).digest()) ** 2
    print(t == (pow(g, r, p) * pow(y, c, p)) % p)