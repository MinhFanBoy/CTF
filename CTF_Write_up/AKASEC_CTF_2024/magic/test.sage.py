

# This file was *autogenerated* from the file test.sage
from sage.all_cmdline import *   # import sage library

_sage_const_4455 = Integer(4455); _sage_const_65537 = Integer(65537); _sage_const_301 = Integer(301); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2)
from pwn import *
from tqdm import *
s = connect("20.80.240.190", _sage_const_4455 )

e = _sage_const_65537 

s.recvuntil(b"= ")
n = int(s.recvline().strip())

bit_flag = "1"
for i in tqdm(range(_sage_const_301 , -_sage_const_1 , -_sage_const_1 )):

    s.sendlineafter(b": ", str(i).encode())
    s.recvuntil(b"= ")
    c = int(s.recvline().strip())

    tmp = int(bit_flag + "1", _sage_const_2 )

    if pow(tmp, e, n) == c:
        bit_flag += "1"
    else:
        bit_flag += "0"

flag = bytes.fromhex(hex(int(bit_flag, _sage_const_2 ))[_sage_const_2 :])
print(flag)

