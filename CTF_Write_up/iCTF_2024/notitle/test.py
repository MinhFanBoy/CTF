
from sympy.ntheory.residue_ntheory import sqrt_mod

p = 11
h = 7
n = 7
p = 0x7AADA0BA1C05D63803BA6BCE66CB6BC091C7ADA62B5CB5BC9F924B528FC113971D4BC54C7FAF3C146ADEB0548BFB9258DFF316741266B802DD7A2F46F77593BAD983E6DF394C1519E8DB0130289FA5A9C628E3ABCE58C63B3379DB7088AAC7A40B63776959774B1B57B8FD316C650AE3C012A91EE653477443446050438A99E79B89B69745BD1918EECB08A0C9D45EF3C61639137F24D979FF380D65C7ABD08785F1AF99729A62F3690747AEC4CCBDA99BAE6E990A0FEFF6F1AB9ABEAFE7FB5BDDB8471C607DEC16198A2AE7776C56B5B6CA24B4C0A2441A047A18EB23302B46CC49ADFF6188FC97C886D5BF67B4B0EFF56762C4E48AAD3F02E7CFE8AA157FB1789B1
# F = Zmod(p ** 2)
# print(phi(F(magic_op(F(2), 7))))
# T_n = lambda x : ((pow((x - sqrt(x**2 - 1)), h, p) + pow((x + sqrt(x**2 - 1)), h, p)) * pow(2, -1, p)) % p
pi = 314159
e = 271828
# phi_pi_1 = 1799541468091901279015980575089118249376218480442750650764202258097088676516318363269774527742885503502901451060149861150386166739780621212248280655282914354617293880504559603848750134319902461773337247230178672056102328300948624868732352958677855259978908838214084965178372719684637348561669196493989624914406954841686467945023929520380896449439194494216243904221077425091585002381969488592891182300289697102125767829294611334248386801261921393879157470340446854674962347105061795364507945179756847507083076370257681524380683471555682300510460681164583802154658483243417783859607862309412733573249627246836178727482979114
# phi_pi_2 = int(pow(1799541468091901279015980575089118249376218480442750650764202258097088676516318363269774527742885503502901451060149861150386166739780621212248280655282914354617293880504559603848750134319902461773337247230178672056102328300948624868732352958677855259978908838214084965178372719684637348561669196493989624914406954841686467945023929520380896449439194494216243904221077425091585002381969488592891182300289697102125767829294611334248386801261921393879157470340446854674962347105061795364507945179756847507083076370257681524380683471555682300510460681164583802154658483243417783859607862309412733573249627246836178727482979114, -1, p))

# magic_pi = 5148814821900119542741261450055292586113647535732067369080655482691554380052565459741879836667166985122205831918390644340336597281539053251470086499523221365132775020379803159725553942273967210168653981106714132657280843578263021148705351143778776029557496571051812809658662726067976153186472043930315453925013490294642486555939775792002395538684028065710983702501767061099948677637628170785784723184512036672606688238070423752236657778483603721097906556034261993570775222774608063476541749544916702299880398045617340589746748928485972604335018907462971390470546547369413439887745742610507865846805659916187409855769246066
# k = magic_pi % phi_pi_1
# K = Zmod(phi_pi_1)
# print(factor(phi_pi_2 - 1, limit = 2 ** 20))
# print(discrete_log(K(k), K(phi_pi_2)))
magic_pi = 5148814821900119542741261450055292586113647535732067369080655482691554380052565459741879836667166985122205831918390644340336597281539053251470086499523221365132775020379803159725553942273967210168653981106714132657280843578263021148705351143778776029557496571051812809658662726067976153186472043930315453925013490294642486555939775792002395538684028065710983702501767061099948677637628170785784723184512036672606688238070423752236657778483603721097906556034261993570775222774608063476541749544916702299880398045617340589746748928485972604335018907462971390470546547369413439887745742610507865846805659916187409855769246066
def magic_op(x, n):
    r0, r1 = 1, x
    for b in f"{n:b}":
        if b == "0":
            r1 = 2 * r0 * r1 - x
            r0 = 2 * r0**2 - 1
        else:
            r0 = 2 * r0 * r1 - x
            r1 = 2 * r1**2 - 1
    return r0
def phi(x, p):
    
    tmp = (pow(x, 2, p) - 1) % p
    
    a = sqrt_mod(tmp, p, True)
    
    k = [(x - i) % p for i in a]
    
    return k

    
    
# print(phi(4, 11))


p = 101
h = 16
n = 7
a = 4
b = magic_op(a, h) % p

for x in phi(b, p):
    for y in phi(a, p):
        print(y)
        print(x * pow(y, -1, p) % p)
        print()